pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
--fishing game üê± 
--by alex & kota
-------------------------------

function _init()
 --set color palette
 reset_pal()
 --shortcuts to make it easier
	--to reset pal
	p=pal
	rp=reset_pal

 --create fish arcetypes
 init_fish()
 
 --set up interactalbes
 init_interactables()
 
 --set update/draw
 _upd=update_game
 _drw=draw_game
 
 --debug
	--add show debug menu item
	menuitem(1,"debug on/off",function()show_debug = not show_debug end)
 
 --init game
 init_game()
end


function _update()
 _upd()
 debug[1]="cpu: "..stat(1)
 debug[2]="mem: "..stat(0)
end


function _draw()
 _drw()
end


--== random helpers ==----------

--printing

--prints with a border
function bprint(text,x,y,c,bc)
 for i=x-1,x+1 do
  for j=y-1,y+1 do
   print(text,i,j,bc)
  end
 end
 print(text,x,y,c)
end

--prints with a centered border
--(set x=63 to center on screen)
function bprint_cent(str,x,y,c,bc)
 bprint(str,x-(#str*2),y,c,bc)
end


--sprites

--outlined sprite
function ospr(c, n, x, y, w, h, flip_x, flip_y)
	w = w or 1
	h = h or 1
	flip_x = flip_x or false
	flip_y = flip_y or false
	
	pal({[0]=c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c}, 0)
	
	spr(n, x-1, y, w, h, flip_x, flip_y)
	spr(n, x+1, y, w, h, flip_x, flip_y)
	spr(n, x, y-1, w, h, flip_x, flip_y)
	spr(n, x, y+1, w, h, flip_x, flip_y)

	pal(0)
	
	spr(n, x, y, w, h, flip_x, flip_y)
end

--outlined special sprite
function osspr(c, sx, sy, sw, sh, dx, dy, dw, dh)
	w = w or 1
	h = h or 1
	flip_x = flip_x or false
	flip_y = flip_y or false
	
	pal({[0]=c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c}, 0)
	
	sspr(sx,sy,sw,sh,dx-1,dy,dw,dh)
	sspr(sx,sy,sw,sh,dx,dy-1,dw,dh)
	sspr(sx,sy,sw,sh,dx+1,dy,dw,dh)
	sspr(sx,sy,sw,sh,dx,dy+1,dw,dh)
	
	pal(0)
	
	sspr(sx,sy,sw,sh,dx,dy,dw,dh)
end


--prints outlined sprites



--colors

--reset color palette
function reset_pal()
 pal()
 --poke( 0x5f2e, 1 ) --endable hidden colors
 custom_palette = {[0]=0,1,140,12,131,3,139,130,136,14,142,143,15,13,6,7}
 pal( custom_palette, 1 )
end


--== debug stuff ==-------------

--debug
debug={}

show_debug=false
function print_debug()
 for i=1,20 do
  if(debug[i]!=nil) then
   bprint(debug[i],cam.x+1,cam.y+1+(i-1)*6,8,0)
  end
 end
end

function draw_hboxs()
 for i in all(interactables) do
  local hb=i.hbox
  fillp(‚ñí)
  rect(hb.x1,hb.y1,hb.x2,hb.y2,8)
  fillp()
 end
end
__gfx__
00077700000000000000000000000000007770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0007a770000000000000000000000000077a70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0007ca7700000000000000000000000077ac70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0007cca77777770000000000000000077acc70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0007cccabbbbb7770000000000000007accc70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0077abbbbbbbbbb70000000000000007abbb70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
007abbbbbbbbbbb70000000000000007abbb70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
077abbabbaaaabb70000000000000007abbb70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
07abbabba777aaa70007777777777007abbb70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77ababb7770777770777abbbbbbb7707abbb70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
7abbbbb70000000077aabbbbbbbbb777abbb77777700000000000000000000000000000000000000000000000000000000000000000000000000000000000000
7abbbb77000000077abbbbbbbbabbbbbbbbbbbbbb770000000000000000000000000000000000000000000000000000000000000000000000000000000000000
7abbbb7000000007abbbbbbbbbbabbbbbbbbbbbbbb70000000000000000000000000000000000000000000000000000000000000000000000000000000000000
7abbb77000000077abbbbb777abbbbbbbbbbbbbbbb70000000000000000000000000000000000000000000000000000000000000000000000000000000000000
7abbb7000000007abbbbb7707abbbbaaabbbbaaaaa70000000000000000000000000000000000000000000000000000000000000000000000000000000000000
7abbb7000000707ab7bb77007a7bb777abbb77777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000
7abbb7700000077ab7bb70007a7bb707abbb70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
7abbbb700000007abbb770077abbb777abbb70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
7abbbb770000777abbb70007abbb7707abbb70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
7aabbbb70000007abbb77077abbbb707abbb70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
77abbbb77707777abbbb777abbbb7707abbb77777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000
07aabbbbb777abbbbbbbbbbbbbbbb777abbbb77abb70000000000000000000000000000000000000000000000000000000000000000000000000000000000000
077abbbbbbbbbbbbabbbbbbbbbbbb707abbbbbbbbb70000000000000000000000000000000000000000000000000000000000000000000000000000000000000
007aaabbbbbbbbb7abbbbbbbbbbbb707aaaaabbbbb70000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00777aabbbbbbbb7aaabbb11111111111111abbbbb11111100000000000000000000000000000000000000000000000000000000000000000000000000000000
000077aaaaaaaa7777aaaa12222222212221aaaaa111222100000000000000000000000000000000000000000000000000000000000000000000000000000000
00000777777777700777771222222221222111111111222100000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000001222111111222112222211222111110000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000001222100001111122222221222122211000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000001222111111222122211221222222221000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000001222222211222122222111222222221000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000001333333311333113333331333113331000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000001222111111222111222221222112221000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000001333100001333133311331333113331000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000001333100001333133333331333113331000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000001222100001222112222211222112221000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000001111100001111111111111111111111000000000000000000000000000000000000000000000000000000000000000000000000000
